@(local: Local)

@import helper._
@import helper.twitterBootstrap._


@main("Cadastrar Dados de Parcelas"){

@form(action = routes.DadosLocal.novo(1), 'id -> "form") {
<div class="">
    <input type="hidden" name="local.id" class="large" placeholder="Local" value="@local.id"> 
    <label>Área Total(ha): </label><input type="text" name="local.areatotal" class="large" placeholder="Area Total" value="@local.area_total" disabled="true">  
    <label>Área da Parcela(m2): </label><input type="text" name="local.areatotal" class="large" placeholder="Area da Parcela">
    <div class="radios">
    <h4>Tipo de Entrada</h4>
    <br />
  	<label class="radio tipo" id="tipo" required>
  		<input type="radio" name="tipo" id="tipo1"  > <label>Entrada Manual (Digitação dos Dados)</label> 
    	<input type="radio" name="tipo" id="tipo2"  > <label>Importação dos Dados apartir de um arquivo txt.</label>
  	</label>
  	<div id="biomassa_manual" style="display: none">
    
        <div id='jqxWidget biomassa'>
            <div class="jqxgrid" id="jqxgrid_parcela"></div>
                <div style='margin-top: 20px;'>
                <div>
                    <input type="button" value="Export to Excel" id='excelExportParcela' class="btn" />
                    <input type="button" value="Adicionar Linha" id='addRowParcela' class="btn" />
                </div>
            </div>
        </div>

    </div>
  	<div id="biomassa_import" style="display: none">Teste 3</div>
    </div>
    <br />
    <hr>
	<input type="button" class="btn btn-small btn-info" name="Calcular" id="Calcular" title="Calcular" value="Calcular">

</div>
}}
<script type="text/javascript">
$(document).ready(function(){
    $(".radios").change(function(){
    	
    	var tipo1 = $("#tipo1").is(":checked");
    	var tipo2 = $("#tipo2").is(":checked");

    	if(tipo1 == true){
    		$("#biomassa_manual").show();
    		$("#biomassa_import").hide();
    	}
    	else if(tipo2 == true){
    		$("#biomassa_manual").hide();
    		$("#biomassa_import").show();
		} 
        else 
			alert("Selecione um Tipo de Entrada!!");


    });
    });
</script>
<script type="text/javascript">
        $(function(){
            var theme = 'base';

            var parcela_source =
            {
                datafields:
                [
                    { name: 'parcela', type: 'number' },
                    { name: 'biomassa', type: 'number' },
                    { name: 'carbono', type: 'number' },
                    { name: 'volume', type: 'number' }
                ]
            };
            var dataAdapterParcela = new $.jqx.dataAdapter(parcela_source);
            // inicializa grid de parcela
            var grid_parcela = $("#jqxgrid_parcela").jqxGrid(
            {
                source: dataAdapterParcela,
                editable: true,
                columnsresize: false,
                selectionmode: 'multiplecellsadvanced',
                theme: theme,
                columns: [
                  { text: 'Parcela', datafield: 'parcela', cellsformat: 'n'},
                  { text: 'Biomassa(ton)', datafield: 'biomassa', cellsformat: 'd' },
                  { text: 'Carbono(ton)', datafield: 'carbono', cellsformat: 'd' },
                  { text: 'Volume(m³)', datafield: 'volume', cellsformat: 'd' }
                ]
            });

            grid_parcela.on('initialized', function(){
                //pré popula com 5 linhas
                for (var i = 5 - 1; i >= 0; i--) {
                    grid_parcela.jqxGrid('addrow', null, { "parcela": grid_parcela.jqxGrid('getrows').length + 1 });
                };
            });

            
            $("#addRowParcela").on('click', function () {
                grid_parcela.jqxGrid('addrow', null, { "parcela": grid_parcela.jqxGrid('getrows').length + 1 });
            });
            
            $("#excelExportParcela").click(function () {
                grid_parcela.jqxGrid('exportdata', 'xls', 'jqxGrid', true);
            });

            
            $("#Calcular").click(function(){
                var rows = grid_parcela.jqxGrid('getrows');
                $.each(rows, function(key, value){
                    console.log(value)
                });
            });
        });
    </script>